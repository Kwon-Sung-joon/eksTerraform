apiVersion: apps/v1                                           
kind: Deployment                                              
metadata:
  name: ksj-web                                              
  labels:
    app: ksj-web                                              
spec:
  replicas: 2 
                                                            
  selector:                                              
    matchLabels:
      app: ksj-web
  template:                                            
    metadata:
      labels:
        app: ksj-web                                               
    spec:
      containers:
      - name: tomcat
        image: kofdx7/tomcat:9.0 
        imagePullPolicy: Always
        ports:
        - containerPort: 8009
          name: ajp
        - containerPort: 8080
          name: tomcat

      - name: apache                                            
        image: kofdx7/apache:2                                               
        imagePullPolicy: Always
        ports:
        - containerPort: 80
          name: http
          #      nodeSelector:
          #   topology.kubernetes.io/zone: ap-northeast-2a
---
apiVersion: v1
kind: Service
metadata:
        name: web-service
spec:
        type: LoadBalancer
        selector:
                app: ksj-web
        ports:
                - protocol: TCP
                  port: 80
                  targetPort: 80 
